{% extends "base.html" %}

{% block page_title %}Profil Ayarları{% endblock %}

{% block content %}

<div style="max-width: 600px; margin: 0 auto;">

    <div class="card" style="padding: 3rem 2rem;">
        <div style="text-align: center; margin-bottom: 30px;">
            <div class="avatar-small"
                style="width: 100px; height: 100px; font-size: 2.5rem; margin: 0 auto 20px auto; background-color: var(--primary);">
                {{ current_user.username[0]|upper }}
            </div>
            <h2>{{ current_user.username }}</h2>
            <p>{{ current_user.email }}</p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div style="margin-bottom: 20px;">
            {% for category, message in messages %}
            <div class="alert {% if category == 'danger' %}alert-danger{% else %}alert-success{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <div style="margin-top: 30px;">
            <h4
                style="border-bottom: 1px solid var(--border); padding-bottom: 10px; margin-bottom: 20px; color: var(--primary);">
                <i class="fa-solid fa-user-pen"></i> Bilgileri Güncelle
            </h4>

            <form method="POST" action="{{ url_for('community.profile') }}">
                <div class="form-group">
                    <label for="username">Kullanıcı Adı</label>
                    <!-- Kullanıcı adını değiştirmeyi genelde frontend tarafında engelleriz veya backend'de izin veririz, burada izin verelim -->
                    <input type="text" id="username" name="username" value="{{ current_user.username }}"
                        class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="email">E-posta</label>
                    <input type="email" id="email" name="email" value="{{ current_user.email }}" class="form-control"
                        required>
                </div>

                <div class="form-group"
                    style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--border);">
                    <label for="password"><i class="fa-solid fa-lock"></i> Yeni Şifre (Değiştirmek istemiyorsanız boş
                        bırakın)</label>
                    <input type="password" id="password" name="password" class="form-control"
                        placeholder="Yeni şifrenizi girin...">
                </div>

                <button type="submit" class="btn btn-primary btn-block" style="margin-top: 20px;">
                    <i class="fa-solid fa-save"></i> Değişiklikleri Kaydet
                </button>
            </form>

            <div style="margin-top: 40px; text-align: center;">
                <a href="{{ url_for('community.logout') }}" class="btn btn-secondary"
                    style="color: var(--danger); border-color: var(--danger);">
                    <i class="fa-solid fa-power-off"></i> Çıkış Yap
                </a>
            </div>
        </div>
    </div>

</div>

{% endblock %}